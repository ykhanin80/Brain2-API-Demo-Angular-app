<div class="data-maintenance order-like-container">
  <!-- List View -->
  <div *ngIf="currentView() === 'list'" class="dm-card">
    <!-- Header -->
    <div class="header">
      <div class="header-left">
        <h1>Data Maintenance - Articles</h1>
        <p class="subtitle">Manage labeler articles with CRUD operations</p>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary" (click)="goToDashboard()">
          <i class="icon-arrow-left"></i>
          Back to Dashboard
        </button>
        <button class="btn btn-primary" (click)="goToCreatePage()">
          <i class="icon-plus"></i>
          Create Article
        </button>
      </div>
    </div>

  <!-- Search Section -->
  <div class="search-section">
    <div class="search-form">
      <div class="form-group">
        <label for="searchNumber">Article Number</label>
        <input
          type="text"
          id="searchNumber"
          [value]="searchParams().articleNumber || ''"
          (input)="updateSearchArticleNumber($event)"
          placeholder="Search by article number..."
        />
      </div>
      
      <div class="form-group">
        <label for="searchName">Article Name</label>
        <input
          type="text"
          id="searchName"
          [value]="searchParams().articleName || ''"
          (input)="updateSearchArticleName($event)"
          placeholder="Search by article name..."
        />
      </div>
      
      <div class="search-actions">
        <button class="btn btn-primary" (click)="onSearch()">
          <i class="icon-search"></i>
          Search
        </button>
        <button class="btn btn-secondary" (click)="clearSearch()">
          <i class="icon-refresh"></i>
          Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="isLoading()" class="loading">
    <div class="spinner"></div>
    <span>Loading articles...</span>
  </div>

  <!-- Error Message -->
  <div *ngIf="error()" class="error-message">
    <i class="icon-alert"></i>
    {{ error() }}
    <button class="btn btn-secondary" (click)="error.set(null)">Dismiss</button>
  </div>

  <!-- Articles Table -->
  <div *ngIf="!isLoading()" class="table-section">
    <div class="table-header">
      <div class="table-info">
        <span class="record-count">
          {{ articles().length }} articles found
        </span>
      </div>
      
      <div class="pagination">
        <button 
          class="btn btn-secondary"
          (click)="previousPage()"
          [disabled]="(searchParams().skip || 0) === 0"
        >
          <i class="icon-chevron-left"></i>
          Previous
        </button>
        
        <span class="page-info">
          {{ (searchParams().skip || 0) + 1 }} - {{ (searchParams().skip || 0) + articles().length }}
        </span>
        
        <button 
          class="btn btn-secondary"
          (click)="nextPage()"
          [disabled]="articles().length < (searchParams().take || 50)"
        >
          Next
          <i class="icon-chevron-right"></i>
        </button>
      </div>
    </div>

    <div class="table-container">
  <table class="articles-table resizable-columns">
        <thead>
          <tr>
            <th>Article Number</th>
            <th>Name</th>
            <th>Unit Price</th>
            <th>Tare</th>
            <th>Labeling Mode</th>
            <th>Label Param #</th>
            <th>Shelf Life 1</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let article of articles()" class="article-row" [class.inactive-row]="!article.active">
            <td class="article-number">{{ article.number }}</td>
            <td class="article-name">{{ article.name || '-' }}</td>
            <td class="unit-price">{{ article.articlePLU.unitPriceValue }} {{ article.gxPriceCurrencyCode || 'USD' }}</td>
            <td class="tare">{{ article.articlePLU.tareWeightValue }} {{ article.weightUnit }}</td>
            <td class="labeling-mode">{{ article.articlePLU.labelingMode || '-' }}</td>
            <td class="label-param">{{ article.articlePLU.labelParameter }}</td>
            <td class="shelf-life">{{ article.articlePLU.shelfLifeDays1 }}</td>
            <td class="actions">
              <button 
                class="btn btn-small btn-icon btn-edit"
                (click)="openEditModal(article)"
                title="Edit Article"
                aria-label="Edit Article"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
              </button>
              <button 
                class="btn btn-small btn-icon btn-copy" disabled
                title="Copy Article (coming soon)"
                aria-label="Copy Article"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M16 1H4a2 2 0 0 0-2 2v14h2V3h12V1zm3 4H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zm0 16H8V7h11v14z"/></svg>
              </button>
              <button 
                class="btn btn-small btn-icon btn-delete"
                (click)="openDeleteConfirm(article)"
                title="Delete Article"
                aria-label="Delete Article"
              >
                <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
              </button>
            </td>
          </tr>
          
          <tr *ngIf="articles().length === 0" class="no-data">
            <td colspan="8">
              <div class="no-data-message">
                <i class="icon-info"></i>
                <span>No articles found. Try adjusting your search criteria or create a new article.</span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  </div> <!-- End List View -->

  <!-- Create Article Page -->
  <div *ngIf="currentView() === 'create'" class="article-page create-article-page dm-card">
    <div class="page-header">
      <div class="header-left">
        <h1>Create New Article</h1>
        <p class="subtitle">Add a new labeler article to the system</p>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary" (click)="goToListPage()">
          <i class="icon-arrow-left"></i>
          Back to List
        </button>
      </div>
    </div>


    <div class="create-form-container">
  <form class="article-form compact-form">
          
          <!-- General Article Information Section -->
          <div class="form-section">
            <h3 class="section-title">📋 General Information</h3>
            <div class="form-row three-cols">
              <div class="form-group">
                <label for="newNumber">Article Number *</label>
                <input
                  type="text"
                  id="newNumber"
                  maxlength="20"
                  [value]="newArticle().number"
                  (input)="updateNewArticleField('number', $event)"
                  placeholder="Enter article number"
                  required
                />
              </div>
              <div class="form-group">
                <label for="newName">Name *</label>
                <input
                  type="text"
                  id="newName"
                  maxlength="64"
                  [value]="newArticle().name"
                  (input)="updateNewArticleField('name', $event)"
                  placeholder="Enter article name"
                  required
                />
              </div>
              <div class="form-group">
                <label for="newDescription">Description</label>
                <input
                  type="text"
                  id="newDescription"
                  maxlength="64"
                  [value]="newArticle().description"
                  (input)="updateNewArticleField('description', $event)"
                  placeholder="Enter description"
                />
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="newWeightUnit">Weight Unit *</label>
                <select
                  id="newWeightUnit"
                  [value]="newArticle().weightUnit"
                  (change)="updateNewArticleField('weightUnit', $event)"
                  required
                >
                  <option value="kg">Kilograms (kg)</option>
                  <option value="lb">Pounds (lb)</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="newWeightDecimals">Weight Decimal Places</label>
                <input
                  type="number"
                  id="newWeightDecimals"
                  [value]="newArticle().weightDecimalPlaces"
                  (input)="updateNewArticleField('weightDecimalPlaces', $event)"
                  min="0"
                  max="6"
                />
              </div>
            </div>
            
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="newArticle().active"
                  (change)="updateNewArticleField('active', $event)"
                />
                <span>Active</span>
              </label>
              
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="newArticle().approved"
                  (change)="updateNewArticleField('approved', $event)"
                />
                <span>Approved</span>
              </label>
            </div>
          </div>

          <!-- Labeler Configuration Section -->
          <div class="form-section">
            <h3 class="section-title">🏷️ Labeler Configuration</h3>
            
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="newArticle().isEnabledForLabelers"
                  (change)="updateNewArticleField('isEnabledForLabelers', $event)"
                />
                <span>Enabled for Labelers</span>
              </label>
              
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="newArticle().isEnabledForGxCheckWeighers"
                  (change)="updateNewArticleField('isEnabledForGxCheckWeighers', $event)"
                />
                <span>Enabled for GX Checkweighers</span>
              </label>
            </div>

            <!-- Labeler General Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">💰 General (Pricing & Shelf Life)</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="newUnitPrice">Unit Price</label>
                  <input
                    type="number"
                    id="newUnitPrice"
                      [value]="unitPriceInput()"
                      (input)="onUnitPriceInput($event)"
                      (blur)="commitUnitPrice()"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newCurrency">Currency Code</label>
                  <select
                    id="newCurrency"
                    [value]="newArticle().gxPriceCurrencyCode || 'USD'"
                    (change)="updateNewArticleField('gxPriceCurrencyCode', $event)"
                  >
                    <option value="USD">USD - US Dollar</option>
                    <option value="CAD">CAD - Canadian Dollar</option>
                    <option value="MXN">MXN - Mexican Peso</option>
                  </select>
                </div>
                
                <!-- Base Price Division - Hidden (hardcoded to 'perUnit') -->
                <!-- <div class="form-group">
                  <label for="newBasePriceDivision">Base Price Division</label>
                  <select
                    id="newBasePriceDivision"
                    [value]="newArticle().articlePLU?.basePriceDivision || 'perUnit'"
                    (change)="updateNewArticlePLUField('basePriceDivision', $event)"
                  >
                    <option value="perUnit">Per Unit</option>
                    <option value="perKg">Per Kg</option>
                    <option value="perLb">Per Lb</option>
                  </select>
                </div> -->
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="newShelfLife1">Shelf Life Days 1</label>
                  <input
                    type="number"
                    id="newShelfLife1"
                    [value]="newArticle().articlePLU?.shelfLifeDays1 || 0"
                    (input)="updateNewArticlePLUField('shelfLifeDays1', $event)"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newShelfLife2">Shelf Life Days 2</label>
                  <input
                    type="number"
                    id="newShelfLife2"
                    [value]="newArticle().articlePLU?.shelfLifeDays2 || 0"
                    (input)="updateNewArticlePLUField('shelfLifeDays2', $event)"
                    min="0"
                  />
                </div>
              </div>
            </div>

            <!-- Labeling Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">⚖️ Labeling (Weights & Mode)</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="newFixedWeight">Fixed Weight {{ getWeightUnitLabel(newArticle()) }}</label>
                  <input
                    type="number"
                    id="newFixedWeight"
                    [value]="newArticle().articlePLU?.fixedWeightValue || 0"
                    (input)="updateNewArticlePLUField('fixedWeightValue', $event)"
                    step="any"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newMinWeight">Min Weight {{ getWeightUnitLabel(newArticle()) }}</label>
                  <input
                    type="number"
                    id="newMinWeight"
                    [value]="newArticle().articlePLU?.minWeightValue || 0"
                    (input)="updateNewArticlePLUField('minWeightValue', $event)"
                    step="any"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newMaxWeight">Max Weight {{ getWeightUnitLabel(newArticle()) }}</label>
                  <input
                    type="number"
                    id="newMaxWeight"
                    [value]="newArticle().articlePLU?.maxWeightValue || 0"
                    (input)="updateNewArticlePLUField('maxWeightValue', $event)"
                    step="any"
                    min="0"
                  />
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="newTareWeight">Tare Weight {{ getWeightUnitLabel(newArticle()) }}</label>
                  <input
                    type="number"
                    id="newTareWeight"
                    [value]="newArticle().articlePLU?.tareWeightValue || 0"
                    (input)="updateNewArticlePLUField('tareWeightValue', $event)"
                    step="any"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newLabelingMode">Labeling Mode</label>
                  <select
                    id="newLabelingMode"
                    [value]="newArticle().articlePLU?.labelingMode || 'fixedWeight'"
                    (change)="updateNewArticlePLUField('labelingMode', $event)"
                  >
                    <option value="weight">Weight</option>
                    <option value="fixedPrice">Fixed Price</option>
                    <option value="fixedWeight">Fixed Weight</option>
                    <option value="fixedValue">Fixed Value</option>
                  </select>
                </div>
              </div>

              <!-- Device Parameters -->
              <div class="form-row">
                <div class="form-group">
                  <label for="newLabelParameter">Label Parameter #</label>
                  <input
                    type="number"
                    id="newLabelParameter"
                    [value]="newArticle().articlePLU?.labelParameter || 0"
                    (input)="updateNewArticlePLUField('labelParameter', $event)"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newAutoLabelParam">Auto Label Parameter</label>
                  <input
                    type="number"
                    id="newAutoLabelParam"
                    [value]="newArticle().articlePLU?.automaticLabelParameter || 0"
                    (input)="updateNewArticlePLUField('automaticLabelParameter', $event)"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newWeightClass">Weight Class #</label>
                  <input
                    type="number"
                    id="newWeightClass"
                    [value]="newArticle().articlePLU?.weightClass || 0"
                    (input)="updateNewArticlePLUField('weightClass', $event)"
                    min="0"
                  />
                </div>
              </div>
            </div>

            <!-- Text Fields Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">📝 Texts (Static & General Texts)</h4>
              <div class="form-group">
                <label for="newStaticText">Static Text #</label>
                <input
                  type="number"
                  id="newStaticText"
                  [value]="newArticle().articlePLU?.staticText || 0"
                  (input)="updateNewArticlePLUField('staticText', $event)"
                  min="0"
                />
              </div>

              <!-- Sample Text Fields (showing first few) -->
              <div class="inline-text-fields">
                <div class="inline-text-field-row">
                  <div class="number-col">
                    <label for="newTextField1Num">Text Field 1 #</label>
                    <input
                      type="text"
                      id="newTextField1Num"
                      inputmode="numeric"
                      pattern="\\d{0,10}"
                      maxlength="10"
                      [value]="rawTextFieldNumbersCreate['textField1'] || (newArticle().articlePLU?.textField1?.number === -1 ? '' : newArticle().articlePLU?.textField1?.number)"
                      (input)="onCreateTextFieldNumberInput('textField1', $event)"
                      (blur)="commitCreateTextFieldNumber('textField1')"
                    />
                  </div>
                  <div class="text-col">
                    <label for="newTextField1Text">Text Field 1 Text</label>
                    <input
                      type="text"
                      id="newTextField1Text"
                      maxlength="64"
                      [value]="newArticle().articlePLU?.textField1?.text || ''"
                      (input)="updateNewArticleTextField('textField1', 'text', $event)"
                    />
                  </div>
                </div>
                <div class="inline-text-field-row">
                  <div class="number-col">
                    <label for="newTextField2Num">Text Field 2 #</label>
                    <input
                      type="text"
                      id="newTextField2Num"
                      inputmode="numeric"
                      pattern="\\d{0,10}"
                      maxlength="10"
                      [value]="newArticle().articlePLU?.textField2?.number || -1"
                      (input)="updateNewArticleTextField('textField2', 'number', $event)"
                    />
                  </div>
                  <div class="text-col">
                    <label for="newTextField2Text">Text Field 2 Text</label>
                    <input
                      type="text"
                      id="newTextField2Text"
                      maxlength="64"
                      [value]="newArticle().articlePLU?.textField2?.text || ''"
                      (input)="updateNewArticleTextField('textField2', 'text', $event)"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Codes Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">🔢 Codes (Code Structures & Substrings)</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="newCodeField1">Code Structure # 1</label>
                  <input
                    type="number"
                    id="newCodeField1"
                    [value]="newArticle().articlePLU?.codeField1 || 0"
                    (input)="updateNewArticlePLUField('codeField1', $event)"
                    min="0"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newCodeString1">Code Substring 1</label>
                  <input
                    type="text"
                    id="newCodeString1"
                    [value]="newArticle().articlePLU?.codeString1 || ''"
                    (input)="updateNewArticlePLUField('codeString1', $event)"
                  />
                </div>
              </div>
            </div>

            <!-- Numbers and Logos Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">🔢 Numbers and Logos</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="newGeneralNumber1">General Number 1</label>
                  <input
                    type="number"
                    id="newGeneralNumber1"
                    [value]="newArticle().articlePLU?.generalNumber1 || 0"
                    (input)="updateNewArticlePLUField('generalNumber1', $event)"
                  />
                </div>
                
                <div class="form-group">
                  <label for="newLogoField1">Logo # 1</label>
                  <input
                    type="number"
                    id="newLogoField1"
                    [value]="newArticle().articlePLU?.logoField1 || 0"
                    (input)="updateNewArticlePLUField('logoField1', $event)"
                    min="0"
                  />
                </div>
              </div>
            </div>
          </div>
        </form>
      
        <div class="form-actions">
          <button class="btn btn-secondary" (click)="goToListPage()">Cancel</button>
          <button 
            class="btn btn-primary" 
            (click)="createArticle()"
            [disabled]="!newArticle().number || !newArticle().name"
          >
            Create Article
          </button>
          <div *ngIf="apiResponse().type" class="api-response inline" [ngClass]="'api-response-' + apiResponse().type">
            <div class="api-response-content">
              <i [class]="apiResponse().type === 'success' ? 'icon-check' : 'icon-alert'"></i>
              <span>{{ apiResponse().message }}</span>
            </div>
          </div>
        </div>
    </div>
  </div> <!-- End Create Article Page -->

  <!-- Edit Article Page -->
  <div *ngIf="currentView() === 'edit' && selectedArticle()" class="article-page edit-article-page dm-card">
    <div class="page-header">
      <div class="header-left">
        <h1>Edit Article: {{ selectedArticle()?.number }}</h1>
        <p class="subtitle">Modify labeler article properties</p>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary" (click)="goToListPage()">
          <i class="icon-arrow-left"></i>
          Back to List
        </button>
      </div>
    </div>

    <!-- API Response Feedback (reuse create styles) -->
    <div *ngIf="apiResponse().type" class="api-response" [ngClass]="'api-response-' + apiResponse().type">
      <div class="api-response-content">
        <i [class]="apiResponse().type === 'success' ? 'icon-check' : 'icon-alert'"></i>
        <span>{{ apiResponse().message }}</span>
        <small *ngIf="apiResponse().timestamp" class="timestamp">
          {{ apiResponse().timestamp | date:'medium' }}
        </small>
      </div>
      <button class="btn-close" (click)="apiResponse.set({ type: null, message: '' })">×</button>
    </div>

    <div class="edit-form-container comprehensive-form">
      <form class="article-form compact-form">
          
          <!-- General Article Information Section -->
          <div class="form-section">
            <h3 class="section-title">📋 General Information</h3>
            <div class="form-row three-cols">
              <div class="form-group">
                <label for="editNumber">Article Number</label>
                <input
                  type="text"
                  id="editNumber"
                  [value]="selectedArticle()?.number"
                  readonly
                  class="readonly article-number-field"
                  maxlength="20"
                />
              </div>
              <div class="form-group">
                <label for="editName">Name *</label>
                <input
                  type="text"
                  id="editName"
                  maxlength="64"
                  [value]="selectedArticle()?.name"
                  (input)="updateSelectedArticleField('name', $event)"
                  placeholder="Enter article name"
                  required
                />
              </div>
              <div class="form-group">
                <label for="editDescription">Description</label>
                <input
                  type="text"
                  id="editDescription"
                  maxlength="64"
                  [value]="selectedArticle()?.description"
                  (input)="updateSelectedArticleField('description', $event)"
                  placeholder="Enter description"
                />
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-group">
                <label for="editWeightUnit">Weight Unit</label>
                <select
                  id="editWeightUnit"
                  [value]="selectedArticle()?.weightUnit"
                  (change)="updateSelectedArticleField('weightUnit', $event)"
                  required
                >
                    <option value="lb">Pounds (lb)</option>
                  <option value="kg">Kilograms (kg)</option>
                   </select>
              </div>
              
              <div class="form-group">
                <label for="editWeightDecimals">Weight Decimal Places</label>
                <input
                  type="number"
                  id="editWeightDecimals"
                  [value]="selectedArticle()?.weightDecimalPlaces"
                  (input)="updateSelectedArticleField('weightDecimalPlaces', $event)"
                  min="0"
                  max="6"
                />
              </div>
            </div>
            
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="selectedArticle()?.active"
                  (change)="updateSelectedArticleField('active', $event)"
                />
                <span>Active</span>
              </label>
              
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="selectedArticle()?.approved"
                  (change)="updateSelectedArticleField('approved', $event)"
                />
                <span>Approved</span>
              </label>
            </div>
          </div>

          <!-- Labeler Configuration Section -->
          <div class="form-section">
            <h3 class="section-title">🏷️ Labeler Configuration</h3>
            
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="selectedArticle()?.isEnabledForLabelers"
                  (change)="updateSelectedArticleField('isEnabledForLabelers', $event)"
                />
                <span>Enabled for Labelers</span>
              </label>
              
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="selectedArticle()?.isEnabledForGxCheckWeighers"
                  (change)="updateSelectedArticleField('isEnabledForGxCheckWeighers', $event)"
                />
                <span>Enabled for GX Checkweighers</span>
              </label>
            </div>

            <!-- Labeler General Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">💰 General (Pricing & Shelf Life)</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="editUnitPrice">Unit Price Value</label>
                  <input
                    type="number"
                    id="editUnitPrice"
                      [value]="selectedUnitPriceInput() || (selectedArticle()?.articlePLU?.unitPriceValue ?? 0)"
                      (input)="onSelectedUnitPriceInput($event)"
                      (blur)="commitSelectedUnitPrice()"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editCurrency">Currency Code</label>
                  <select
                    id="editCurrency"
                    [value]="selectedArticle()?.gxPriceCurrencyCode || 'USD'"
                    (change)="updateSelectedArticleField('gxPriceCurrencyCode', $event)"
                  >
                    <option value="USD">USD - US Dollar</option>
                    <option value="CAD">CAD - Canadian Dollar</option>
                    <option value="MXN">MXN - Mexican Peso</option>
                    <option value="EUR">EUR - Euro</option>
                    <option value="GBP">GBP - British Pound</option>
                  </select>
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="editShelfLife1">Shelf Life Days 1</label>
                  <input
                    type="number"
                    id="editShelfLife1"
                    [value]="selectedArticle()?.articlePLU?.shelfLifeDays1 || 0"
                    (input)="updateSelectedArticlePLUField('shelfLifeDays1', $event)"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editShelfLife2">Shelf Life Days 2</label>
                  <input
                    type="number"
                    id="editShelfLife2"
                    [value]="selectedArticle()?.articlePLU?.shelfLifeDays2 || 0"
                    (input)="updateSelectedArticlePLUField('shelfLifeDays2', $event)"
                    min="0"
                    class="number-field"
                  />
                </div>
              </div>
            </div>

            <!-- Labeling Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">⚖️ Labeling (Weights & Mode)</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="editFixedWeight">Fixed Weight {{ getWeightUnitLabel(selectedArticle()) }}</label>
                  <input
                    type="number"
                    id="editFixedWeight"
                    [value]="selectedArticle()?.articlePLU?.fixedWeightValue || 0"
                    (input)="updateSelectedArticlePLUField('fixedWeightValue', $event)"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editMinWeight">Min Weight {{ getWeightUnitLabel(selectedArticle()) }}</label>
                  <input
                    type="number"
                    id="editMinWeight"
                    [value]="selectedArticle()?.articlePLU?.minWeightValue || 0"
                    (input)="updateSelectedArticlePLUField('minWeightValue', $event)"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editMaxWeight">Max Weight {{ getWeightUnitLabel(selectedArticle()) }}</label>
                  <input
                    type="number"
                    id="editMaxWeight"
                    [value]="selectedArticle()?.articlePLU?.maxWeightValue || 0"
                    (input)="updateSelectedArticlePLUField('maxWeightValue', $event)"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="editTareWeight">Tare Weight {{ getWeightUnitLabel(selectedArticle()) }}</label>
                  <input
                    type="number"
                    id="editTareWeight"
                    [value]="selectedArticle()?.articlePLU?.tareWeightValue || 0"
                    (input)="updateSelectedArticlePLUField('tareWeightValue', $event)"
                    step="any"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editLabelingMode">Labeling Mode</label>
                  <select
                    id="editLabelingMode"
                    [value]="selectedArticle()?.articlePLU?.labelingMode || 'fixedWeight'"
                    (change)="updateSelectedArticlePLUField('labelingMode', $event)"
                  >
                    <option value="weight">Weight</option>
                    <option value="fixedPrice">Fixed Price</option>
                    <option value="fixedWeight">Fixed Weight</option>
                    <option value="fixedValue">Fixed Value</option>
                  </select>
                </div>
              </div>

              <!-- Device Parameters -->
              <div class="form-row">
                <div class="form-group">
                  <label for="editLabelParameter">Label Parameter #</label>
                  <input
                    type="number"
                    id="editLabelParameter"
                    [value]="selectedArticle()?.articlePLU?.labelParameter || 0"
                    (input)="updateSelectedArticlePLUField('labelParameter', $event)"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editAutoLabelParam">Auto Label Parameter</label>
                  <input
                    type="number"
                    id="editAutoLabelParam"
                    [value]="selectedArticle()?.articlePLU?.automaticLabelParameter || 0"
                    (input)="updateSelectedArticlePLUField('automaticLabelParameter', $event)"
                    min="0"
                    class="number-field"
                  />
                </div>
                
                <div class="form-group">
                  <label for="editWeightClass">Weight Class #</label>
                  <input
                    type="number"
                    id="editWeightClass"
                    [value]="selectedArticle()?.articlePLU?.weightClass || 0"
                    (input)="updateSelectedArticlePLUField('weightClass', $event)"
                    min="0"
                    class="number-field"
                  />
                </div>
              </div>
            </div>

            <!-- Text Fields Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">📝 Texts (Static & General Texts)</h4>
              <div class="form-group">
                <label for="editStaticText">Static Text #</label>
                <input
                  type="number"
                  id="editStaticText"
                  [value]="selectedArticle()?.articlePLU?.staticText || 0"
                  (input)="updateSelectedArticlePLUField('staticText', $event)"
                  min="0"
                  class="number-field"
                />
              </div>

              <!-- Dynamic Text Fields with non -1 values -->
              <div class="dynamic-fields-container">
                <h5 class="field-group-title">Text Fields (showing fields with number ≠ -1)</h5>
                <div *ngFor="let textField of getTextFieldsWithValues(selectedArticle())" class="text-field-row">
                  <div class="form-row">
                    <div class="form-group field-number">
                      <label [for]="'edit' + textField.key + 'Num'">Text Field {{ textField.index }} Number</label>
                      <input
                        type="text"
                        inputmode="numeric"
                        pattern="\\d{0,10}"
                        maxlength="10"
                        [id]="'edit' + textField.key + 'Num'"
                        [value]="textField.field.number === -1 ? '' : textField.field.number"
                        (input)="onEditTextFieldNumberInput(textField.key, $event)"
                        class="number-field no-spinner"
                      />
                    </div>
                    <div class="form-group field-text">
                      <label [for]="'edit' + textField.key + 'Text'">Text Field {{ textField.index }} Text</label>
                      <textarea
                        [id]="'edit' + textField.key + 'Text'"
                        [value]="textField.field.text || ''"
                        (input)="updateSelectedArticleTextFieldDynamic(textField.key, 'text', $event)"
                        rows="2"
                        class="text-area-field"
                      ></textarea>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Dynamic Simple Texts with non-empty values -->
              <div class="dynamic-fields-container">
                <h5 class="field-group-title">Simple Texts (showing non-empty fields)</h5>
                <div *ngFor="let simpleText of getSimpleTextsWithValues(selectedArticle())" class="simple-text-row">
                  <div class="form-group">
                    <label [for]="'edit' + simpleText.key">Simple Text {{ simpleText.index }}</label>
                    <input
                      type="text"
                      [id]="'edit' + simpleText.key"
                      [value]="simpleText.value"
                      (input)="updateSelectedArticlePLUFieldDynamic(simpleText.key, $event)"
                      class="text-field"
                    />
                  </div>
                </div>
              </div>
            </div>

            <!-- Codes Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">🔢 Codes (Code Structures & Substrings)</h4>
              
              <!-- Dynamic Code Fields with non-zero values -->
              <div class="dynamic-fields-container">
                <h5 class="field-group-title">Code Fields (showing non-zero values)</h5>
                <div *ngFor="let codeField of getCodeFieldsWithValues(selectedArticle())" class="code-field-row">
                  <div class="form-row">
                    <div class="form-group">
                      <label [for]="'edit' + codeField.fieldKey">Code Structure # {{ codeField.index }}</label>
                      <input
                        type="number"
                        [id]="'edit' + codeField.fieldKey"
                        [value]="codeField.fieldValue"
                        (input)="updateSelectedArticlePLUFieldDynamic(codeField.fieldKey, $event)"
                        min="0"
                        class="number-field"
                      />
                    </div>
                    
                    <div class="form-group">
                      <label [for]="'edit' + codeField.stringKey">Code Substring {{ codeField.index }}</label>
                      <input
                        type="text"
                        [id]="'edit' + codeField.stringKey"
                        [value]="codeField.stringValue"
                        (input)="updateSelectedArticlePLUFieldDynamic(codeField.stringKey, $event)"
                        class="text-field"
                      />
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Numbers and Logos Sub-section -->
            <div class="form-subsection">
              <h4 class="subsection-title">🔢 Numbers and Logos</h4>
              
              <!-- Dynamic General Numbers with non-zero values -->
              <div class="dynamic-fields-container">
                <h5 class="field-group-title">General Numbers (showing non-zero values)</h5>
                <div class="numbers-grid">
                  <div *ngFor="let generalNumber of getGeneralNumbersWithValues(selectedArticle())" class="form-group">
                    <label [for]="'edit' + generalNumber.key">General Number {{ generalNumber.index }}</label>
                    <input
                      type="number"
                      [id]="'edit' + generalNumber.key"
                      [value]="generalNumber.value"
                      (input)="updateSelectedArticlePLUFieldDynamic(generalNumber.key, $event)"
                      class="number-field"
                    />
                  </div>
                </div>
              </div>

              <!-- Dynamic Logo Fields with non-zero values -->
              <div class="dynamic-fields-container">
                <h5 class="field-group-title">Logo Fields (showing non-zero values)</h5>
                <div class="logos-grid">
                  <div *ngFor="let logo of getLogosWithValues(selectedArticle())" class="form-group">
                    <label [for]="'edit' + logo.key">Logo # {{ logo.index }}</label>
                    <input
                      type="number"
                      [id]="'edit' + logo.key"
                      [value]="logo.value"
                      (input)="updateSelectedArticlePLUFieldDynamic(logo.key, $event)"
                      min="0"
                      class="number-field"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
      </form>
      <div class="form-actions">
        <button class="btn btn-secondary" (click)="goToListPage()">Cancel</button>
        <button class="btn btn-primary" (click)="updateArticle(selectedArticle()!)">Update Article</button>
      </div>
    </div>
  </div> <!-- End Edit Article Page -->

  <!-- Delete Confirmation Modal -->
  <div *ngIf="showDeleteConfirm() && selectedArticle()" class="modal-overlay" (click)="closeDeleteConfirm()">
    <div class="modal modal-small" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Confirm Delete</h2>
        <button class="btn btn-text" (click)="closeDeleteConfirm()">
          <i class="icon-close"></i>
        </button>
      </div>
      
      <div class="modal-body">
        <div class="delete-confirmation">
          <div class="warning-icon">
            <i class="icon-alert-triangle"></i>
          </div>
          <div class="delete-message">
            <p>Are you sure you want to delete this article?</p>
            <p class="article-info">
              <strong>{{ selectedArticle()?.number }}</strong> - {{ selectedArticle()?.name }}
            </p>
            <p class="warning-text">This action cannot be undone.</p>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeDeleteConfirm()">Cancel</button>
        <button 
          class="btn btn-danger" 
          (click)="deleteArticle(selectedArticle()!.number)"
        >
          Delete Article
        </button>
      </div>
    </div>
  </div>

  <!-- API Response Debug Window -->
  <section class="debug-section">
    <div class="debug-header-bar">
      <h3>🔧 API Response Debug</h3>
      <div class="debug-global-actions">
        <button type="button" class="debug-tab" (click)="jsonCollapsed.set(!jsonCollapsed())">
          {{ jsonCollapsed() ? 'Expand All' : 'Collapse All' }}
        </button>
      </div>
    </div>
    <div class="debug-container">
      <div class="debug-tabs">
        <button 
          type="button" 
          class="debug-tab" 
          [class.active]="activeDebugTab === 'list'"
          (click)="activeDebugTab = 'list'"
        >
          List Articles Response
        </button>
        <button 
          type="button" 
          class="debug-tab" 
          [class.active]="activeDebugTab === 'get'"
          (click)="activeDebugTab = 'get'"
        >
          Get Article Response
        </button>
        <button 
          type="button" 
          class="debug-tab" 
          [class.active]="activeDebugTab === 'create'"
          (click)="activeDebugTab = 'create'"
        >
          Create Article Response
        </button>
        <button 
          type="button" 
          class="debug-tab" 
          [class.active]="activeDebugTab === 'update'"
          (click)="activeDebugTab = 'update'"
        >
          Update Article Response
        </button>
        <button 
          type="button" 
          class="debug-tab" 
          [class.active]="activeDebugTab === 'delete'"
          (click)="activeDebugTab = 'delete'"
        >
          Delete Article Response
        </button>
      </div>
      
      <div class="debug-content" [class.collapsed]="jsonCollapsed()">
        <div *ngIf="activeDebugTab === 'list'" class="debug-panel">
          <div class="debug-header">
            <h4>Latest List Articles API Response</h4>
            <small>{{articles().length}} articles loaded</small>
          </div>
          <pre *ngIf="!jsonCollapsed()" class="debug-json">{{debugApiResponses.listArticles | json}}</pre>
        </div>

        <div *ngIf="activeDebugTab === 'get'" class="debug-panel">
          <div class="debug-header">
            <h4>Get Article by Number API Response</h4>
            <small>Single article details</small>
          </div>
          <pre *ngIf="!jsonCollapsed()" class="debug-json">{{debugApiResponses.getArticle | json}}</pre>
        </div>

        <div *ngIf="activeDebugTab === 'create'" class="debug-panel">
          <div class="debug-header">
            <h4>Create Article API Response</h4>
            <small>POST request details</small>
          </div>
          <pre *ngIf="!jsonCollapsed()" class="debug-json">{{debugApiResponses.createArticle | json}}</pre>
        </div>

        <div *ngIf="activeDebugTab === 'update'" class="debug-panel">
          <div class="debug-header">
            <h4>Update Article API Response</h4>
            <small>PATCH request details</small>
          </div>
          <pre *ngIf="!jsonCollapsed()" class="debug-json">{{debugApiResponses.updateArticle | json}}</pre>
        </div>

        <div *ngIf="activeDebugTab === 'delete'" class="debug-panel">
          <div class="debug-header">
            <h4>Delete Article API Response</h4>
            <small>DELETE request details</small>
          </div>
          <pre *ngIf="!jsonCollapsed()" class="debug-json">{{debugApiResponses.deleteArticle | json}}</pre>
        </div>
      </div>
    </div>
  </section>
</div>
